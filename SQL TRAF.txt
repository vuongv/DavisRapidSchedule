DROP Table `TRAF_MONDAY`;
DROP Table `TRAF_TUESDAY`;
DROP Table `TRAF_WEDNESDAY`;
DROP Table `TRAF_THURSDAY`;
DROP Table `TRAF_FRIDAY`;
DROP Table `TRAF_SATURDAY`;

ALTER TABLE `TABLE 18` RENAME TO `TRAF_MONDAY`;
ALTER TABLE `TABLE 19` RENAME TO `TRAF_TUESDAY`;
ALTER TABLE `TABLE 20` RENAME TO `TRAF_WEDNESDAY`;
ALTER TABLE `TABLE 21` RENAME TO `TRAF_THURSDAY`;
ALTER TABLE `TABLE 22` RENAME TO `TRAF_FRIDAY`;
ALTER TABLE `TABLE 23` RENAME TO `TRAF_SATURDAY`;

UPDATE `TRAF_MONDAY` SET `IT` = "N" WHERE `IT` = "Y";
UPDATE `TRAF_TUESDAY` SET `IT` = "N" WHERE `IT` = "Y";
UPDATE `TRAF_WEDNESDAY` SET `IT` = "N" WHERE `IT` = "Y";
UPDATE `TRAF_THURSDAY` SET `IT` = "N" WHERE `IT` = "Y";
UPDATE `TRAF_FRIDAY` SET `IT` = "N" WHERE `IT` = "Y";
UPDATE `TRAF_SATURDAY` SET `IT` = "N" WHERE `IT` = "Y";

ALTER TABLE `TRAF_MONDAY` MODIFY COLUMN `Mtg_Start` TIME(6);
ALTER TABLE `TRAF_MONDAY` MODIFY COLUMN `Mtg_End` TIME;

ALTER TABLE `TRAF_TUESDAY` MODIFY COLUMN `Mtg_Start` TIME(6);
ALTER TABLE `TRAF_TUESDAY` MODIFY COLUMN `Mtg_End` TIME;

ALTER TABLE `TRAF_WEDNESDAY` MODIFY COLUMN `Mtg_Start` TIME(6);
ALTER TABLE `TRAF_WEDNESDAY` MODIFY COLUMN `Mtg_End` TIME;

ALTER TABLE `TRAF_THURSDAY` MODIFY COLUMN `Mtg_Start` TIME(6);
ALTER TABLE `TRAF_THURSDAY` MODIFY COLUMN `Mtg_End` TIME;

ALTER TABLE `TRAF_FRIDAY` MODIFY COLUMN `Mtg_Start` TIME(6);
ALTER TABLE `TRAF_FRIDAY` MODIFY COLUMN `Mtg_End` TIME;

ALTER TABLE `TRAF_SATURDAY` MODIFY COLUMN `Mtg_Start` TIME(6);
ALTER TABLE `TRAF_SATURDAY` MODIFY COLUMN `Mtg_End` TIME;

DELETE FROM `TRAF_MONDAY` WHERE `Class_Nbr` = "";
DELETE FROM `TRAF_TUESDAY` WHERE `Class_Nbr` = "";
DELETE FROM `TRAF_WEDNESDAY` WHERE `Class_Nbr` = "";
DELETE FROM `TRAF_THURSDAY` WHERE `Class_Nbr` = "";
DELETE FROM `TRAF_FRIDAY` WHERE `Class_Nbr` = "";
DELETE FROM `TRAF_SATURDAY` WHERE `Class_Nbr` = "";

ALTER TABLE `TRAF_MONDAY` MODIFY COLUMN `Mtg_Start` TIME(6);
ALTER TABLE `TRAF_MONDAY` MODIFY COLUMN `Mtg_End` TIME;

ALTER TABLE `TRAF_TUESDAY` MODIFY COLUMN `Mtg_Start` TIME(6);
ALTER TABLE `TRAF_TUESDAY` MODIFY COLUMN `Mtg_End` TIME;

ALTER TABLE `TRAF_WEDNESDAY` MODIFY COLUMN `Mtg_Start` TIME(6);
ALTER TABLE `TRAF_WEDNESDAY` MODIFY COLUMN `Mtg_End` TIME;

ALTER TABLE `TRAF_THURSDAY` MODIFY COLUMN `Mtg_Start` TIME(6);
ALTER TABLE `TRAF_THURSDAY` MODIFY COLUMN `Mtg_End` TIME;

ALTER TABLE `TRAF_FRIDAY` MODIFY COLUMN `Mtg_Start` TIME(6);
ALTER TABLE `TRAF_FRIDAY` MODIFY COLUMN `Mtg_End` TIME;

ALTER TABLE `TRAF_SATURDAY` MODIFY COLUMN `Mtg_Start` TIME(6);
ALTER TABLE `TRAF_SATURDAY` MODIFY COLUMN `Mtg_End` TIME;

UPDATE `TRAF_MONDAY` a
SET a.IT = "Y"
WHERE a.Facility_ID IN ( SELECT DISTINCT e.Facility_ID from `TRAF_MONDAY` e
							Where e.Facility_ID IN (Select distinct a.Facility_ID from `TRAF_MONDAY` a 
							LEFT JOIN `CHECK_TRAF` b 
							ON a.Facility_ID = b.Facility_ID 
							WHERE b.Facility_ID = a.Facility_ID ));

UPDATE `TRAF_TUESDAY` a
SET a.IT = "Y"
WHERE a.Facility_ID IN ( SELECT DISTINCT e.Facility_ID from `TRAF_TUESDAY` e
							Where e.Facility_ID IN (Select distinct a.Facility_ID from `TRAF_TUESDAY` a 
							LEFT JOIN `CHECK_TRAF` b 
							ON a.Facility_ID = b.Facility_ID 
							WHERE b.Facility_ID = a.Facility_ID ));

UPDATE `TRAF_WEDNESDAY` a
SET a.IT = "Y"
WHERE a.Facility_ID IN ( SELECT DISTINCT e.Facility_ID from `TRAF_WEDNESDAY` e
							Where e.Facility_ID IN (Select distinct a.Facility_ID from `TRAF_WEDNESDAY` a 
							LEFT JOIN `CHECK_TRAF` b 
							ON a.Facility_ID = b.Facility_ID 
							WHERE b.Facility_ID = a.Facility_ID ));

UPDATE `TRAF_THURSDAY` a
SET a.IT = "Y"
WHERE a.Facility_ID IN ( SELECT DISTINCT e.Facility_ID from `TRAF_THURSDAY` e
							Where e.Facility_ID IN (Select distinct a.Facility_ID from `TRAF_THURSDAY` a 
							LEFT JOIN `CHECK_TRAF` b 
							ON a.Facility_ID = b.Facility_ID 
							WHERE b.Facility_ID = a.Facility_ID ));

UPDATE `TRAF_FRIDAY` a
SET a.IT = "Y"
WHERE a.Facility_ID IN ( SELECT DISTINCT e.Facility_ID from `TRAF_FRIDAY` e
							Where e.Facility_ID IN (Select distinct a.Facility_ID from `TRAF_FRIDAY` a 
							LEFT JOIN `CHECK_TRAF` b 
							ON a.Facility_ID = b.Facility_ID 
							WHERE b.Facility_ID = a.Facility_ID ));

UPDATE `TRAF_SATURDAY` a
SET a.IT = "Y"
WHERE a.Facility_ID IN ( SELECT DISTINCT e.Facility_ID from `TRAF_SATURDAY` e
							Where e.Facility_ID IN (Select distinct a.Facility_ID from `TRAF_SATURDAY` a 
							LEFT JOIN `CHECK_TRAF` b 
							ON a.Facility_ID = b.Facility_ID 
							WHERE b.Facility_ID = a.Facility_ID ));
